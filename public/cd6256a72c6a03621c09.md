---
title: Macã«PostgreSQL9.6.3ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ãŸ
tags:
  - Mac
  - PostgreSQL
  - PostgreSQL9.6
private: false
updated_at: '2021-04-12T16:58:54+09:00'
id: cd6256a72c6a03621c09
organization_url_name: null
slide: false
---
## ç’°å¢ƒ

- OSï¼šmacOS Sierra 10.12.3
- Homebrewï¼š1.2.0 Homebrew/homebrew-core (git revision 5045; last commit 2017-05-11)
- PostgreSQLï¼š9.6.3

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### PostgreSQLã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Homebrewã‚’ä½¿ãˆã°ä¸€ç™ºã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚
Homebrewã‚’æœ€æ–°ã«ã—ã¦ã‹ã‚‰PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```shell-session
$ brew update
â€¦
$ brew install postgresql
==> Downloading https://homebrew.bintray.com/bottles/postgresql-9.6.3.sierra.bot
######################################################################## 100.0%
==> Pouring postgresql-9.6.3.sierra.bottle.tar.gz
==> Using the sandbox
==> /usr/local/Cellar/postgresql/9.6.3/bin/initdb /usr/local/var/postgres
==> Caveats
If builds of PostgreSQL 9 are failing and you have version 8.x installed,
you may need to remove the previous version first. See:
  https://github.com/Homebrew/legacy-homebrew/issues/2510

To migrate existing data from a previous major version (pre-9.0) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.6/static/upgrading.html

To migrate existing data from a previous minor version (9.0-9.5) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.6/static/pgupgrade.html

  You will need your previous PostgreSQL installation from brew to perform `pg_upgrade`.
  Do not run `brew cleanup postgresql` until you have performed the migration.

To have launchd start postgresql now and restart at login:
  brew services start postgresql
Or, if you don't want/need a background service you can just run:
  pg_ctl -D /usr/local/var/postgres start
==> Summary
ğŸº /usr/local/Cellar/postgresql/9.6.3: 3,259 files, 36.6MB
```

ã‚¨ãƒ©ãƒ¼ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã®ã§ã™ãŒã€Googleç¿»è¨³ã§ç¢ºèªã—ãŸã¨ã“ã‚ã€ãŸã ã®è­¦å‘Šã§ã—ãŸã€‚
ã™ã§ã«PostgreSQLãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆã®æ³¨æ„ç‚¹ã¨ã€PostgreSQLã®èµ·å‹•æ–¹æ³•ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç¢ºèª

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‹ã©ã†ã‹ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚

```shell-session
$ psql --version
psql (PostgreSQL) 9.6.3
```

`9.6.3` ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«æˆåŠŸã—ã¦ã„ã¾ã™ã€‚

### åˆæœŸåŒ–

`-E` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«UTF-8ã‚’æŒ‡å®šã—ã¦DBã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚
åˆæœŸåŒ–æ™‚ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã„ã†DBã®é›†åˆä½“ã‚’ä½œæˆã—ã¾ã™ã€‚

```shell-session
$ initdb /usr/local/var/postgres/ -E utf8
The files belonging to this database system will be owned by user "{ãƒ¦ãƒ¼ã‚¶ãƒ¼å}".
This user must also own the server process.

The database cluster will be initialized with locale "ja_JP.UTF-8".
initdb: could not find suitable text search configuration for locale "ja_JP.UTF-8"
The default text search configuration will be set to "simple".

Data page checksums are disabled.

initdb: directory "/usr/local/var/postgres" exists but is not empty
If you want to create a new database system, either remove or empty
the directory "/usr/local/var/postgres" or run initdb
with an argument other than "/usr/local/var/postgres".
```

ã“ã¡ã‚‰ã‚‚ã‚¨ãƒ©ãƒ¼ã«è¦‹ãˆã‚‹ã®ã§ã™ãŒã€å•é¡Œãªã„ã¯ãšã§ã™ã€‚

## æ“ä½œæ–¹æ³•

### ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«è¨€ã‚ã‚ŒãŸé€šã‚Šã€ `brew services start postgresql` ã§èµ·å‹•ã—ã¾ã™ã€‚

```shell-session
$ brew services start postgresql
==> Tapping homebrew/services
Cloning into '/usr/local/Homebrew/Library/Taps/homebrew/homebrew-services'...
remote: Counting objects: 10, done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 10 (delta 0), reused 5 (delta 0), pack-reused 0
Unpacking objects: 100% (10/10), done.
Tapped 0 formulae (37 files, 51KB)
==> Successfully started `postgresql` (label: homebrew.mxcl.postgresql)
```
ç§ã®ç’°å¢ƒã§ã¯ã‚­ãƒ¼ãƒã‚§ãƒ¼ãƒ³ã®ç¢ºèªãŒ2å›ã»ã©ã‚ã‚Šã¾ã—ãŸã®ã§ã€ä¸¡æ–¹ã¨ã‚‚ã€Œè¨±å¯ã€ã‚’é¸æŠã—ã¾ã—ãŸã€‚

### DBä¸€è¦§ã®å–å¾—

`psql -l` ã§DBã®ä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

```shell-session
$ psql -l
                                        List of databases
   Name    |    Owner     | Encoding |   Collate   |    Ctype    |       Access privileges       
-----------+--------------+----------+-------------+-------------+-------------------------------
 postgres  |  {user name} | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | 
 template0 |  {user name} | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/{user name}              +
           |              |          |             |             | {user name}=CTc/{user name}
 template1 |  {user name} | UTF8     | ja_JP.UTF-8 | ja_JP.UTF-8 | =c/{user name}              +
           |              |          |             |             | {user name}=CTc/{user name}
(3 rows)
```

åˆæœŸåŒ–ç›´å¾Œã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹ã‚¿ã«ã¯3ã¤ã®DBãŒå­˜åœ¨ã—ã¾ã™ã€‚

### DBã®ä½œæˆ

`createdb {DBå}` ã§DBã‚’æ–°è¦ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€Œtestã€ã¨ã„ã†åå‰ã®DBã‚’ä½œæˆã—ã¾ã™ã€‚

```shell-session
$ createdb test
```

### DBã¸ã®æ¥ç¶š

`psql {DBå}` ã§DBã¸æ¥ç¶šã—ã¾ã™ã€‚æ¥ç¶šã™ã‚‹ã“ã¨ã§SQLã®ç™ºè¡ŒãŒè¡Œãˆã¾ã™ã€‚

```shell-session
$ psql test
psql (9.6.3)
Type "help" for help.

test=#
```

ã“ã“ã§ã¯çœç•¥ã—ã¾ã›ã‚“ã§ã—ãŸãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨DBåãŒåŒä¸€ã®å ´åˆã«ã¯DBåã‚’çœç•¥ã§ãã¾ã™ã€‚

### ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

`CREATE TABLE` ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€Œtest_tableã€ã¨ã„ã†åå‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```shell-session
test=# create table test_table (
test(# id integer not null,
test(# name varchar(20),
test(# primary key(id)
test(# )
test(# ;
CREATE TABLE
```

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

PostgreSQLã§ã¯ `\` ã‹ã‚‰å§‹ã¾ã‚‹ä¾¿åˆ©ãªã‚³ãƒãƒ³ãƒ‰ãŒã„ã‚ã„ã‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

|ã‚³ãƒãƒ³ãƒ‰|èª¬æ˜|
|:--|:--|
|\l|DBä¸€è¦§å–å¾—|
|\d|ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§å–å¾—|
|\d {ãƒ†ãƒ¼ãƒ–ãƒ«å}|å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸€è¦§å–å¾—|
|\i {SQLãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹}|SQLãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ|
|\q|DBåˆ‡æ–­|

#### DBä¸€è¦§ã®å–å¾—

`psql -l` ã¨åŒæ§˜ãªã®ã§èª¬æ˜ã‚’çœç•¥ã—ã¾ã™ã€‚

#### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã®å–å¾—

`\d` ã§ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

```shell-session
test=# \d
             List of relations
 Schema |    Name    | Type  |    Owner     
--------+------------+-------+--------------
 public | test_table | table |  {user name}
(1 row)
```

#### ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸€è¦§ã®å–å¾—

`\d {ãƒ†ãƒ¼ãƒ–ãƒ«å}` ã§å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ä¸€è¦§ã‚’å–å¾—ã—ã¾ã™ã€‚

```shell-session
test=# \d test_table
         Table "public.test_table"
 Column |         Type          | Modifiers 
--------+-----------------------+-----------
 id     | integer               | not null
 name   | character varying(20) | 
Indexes:
    "test_table_pkey" PRIMARY KEY, btree (id)
```

#### SQLãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ

`\i {SQLãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹}` ã§äºˆã‚ç”¨æ„ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹SQLã‚’ã¾ã¨ã‚ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

```sql:test.sql
insert into test_table (id, name) values (1, 'hoge');
insert into test_table (id, name) values (2, 'huga');
```

```shell-session
test=# \i ~/Desktop/test.sql
INSERT 0 1
INSERT 0 1
test=# select * from test_table;
 id | name
----+------
  1 | hoge
  2 | huga
(2 rows)
```

#### DBã®åˆ‡æ–­

`\q` ã§DBã‚’åˆ‡æ–­ã—ã¾ã™ã€‚

```shell-session
test=# \q
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢

`brew services stop postgresql` ã§DBã‚’åœæ­¢ã—ã¾ã™ã€‚
`brew services list` ã§ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•çŠ¶æ³ã‚’å–å¾—ã—ã¾ã™ã€‚

|Status|èª¬æ˜|
|:--|:--|
|started|èµ·å‹•ä¸­|
|stopped|åœæ­¢ä¸­|

```shell-session
$ brew services list
Name       Status  User         Plist
postgresql started {user name}  /Users/{user name}/Library/LaunchAgents/homebrew.mxcl.postgresql.plist

$ brew services stop postgresql
Stopping `postgresql`... (might take a while)
==> Successfully stopped `postgresql` (label: homebrew.mxcl.postgresql)

$ brew services list
Name       Status  User Plist
postgresql stopped
```

## å‚è€ƒãƒªãƒ³ã‚¯

- [Macã«PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« - Qiita](http://qiita.com/_daisuke/items/13996621cf51f835494b)
- [OS X ã« PostgreSQL ã‚’ Homebrew ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ brew services ã§èµ·å‹•ã™ã‚‹ - Qiita](http://qiita.com/takuya0301/items/c0720753de98572703b8)
- [PostgreSQLã€€åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§](http://sasuke.main.jp/postgrescmd.html)
- [ç¬¬18å›ã€€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹ã‚¿ï½œã‚ªã‚¹ã‚¹ãƒ¡ï¼OSS-DBæƒ…å ±ï½œOSS-DBé“å ´ï½œå—é¨“å¯¾ç­–ï½œDBã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã‚’èªå®šã™ã‚‹è³‡æ ¼ OSS-DBæŠ€è¡“è€…èªå®šè©¦é¨“](http://www.oss-db.jp/measures/dojo_18.shtml)
