---
title: Swift Packagesã§CLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹æ–¹æ³•
tags:
  - macOS
  - Swift
  - SwiftPackageManager
  - SwiftPM
private: false
updated_at: '2021-10-05T23:48:24+09:00'
id: 4a4d9694e8a362b6885f
organization_url_name: null
slide: false
---
ã€ŒSwift Packagesã«ã‚ˆã‚‹CLIãƒ„ãƒ¼ãƒ«ã®ä½œæˆæ–¹æ³•ã€ã¯5éƒ¨æ§‹æˆã§ã™ã€‚
è¨˜äº‹ã‚’é †ç•ªã«èª­ã¿é€²ã‚ã‚‹ã¨ã€Swift Packagesã§CLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã—ã¦å…¬é–‹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ç¬¬1éƒ¨: Swift Packagesã§CLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹ã€€__â†ã‚¤ãƒã‚³ã‚³__
ç¬¬2éƒ¨: [è‡ªä½œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’Swift Package Indexã«è¿½åŠ ã™ã‚‹](https://qiita.com/uhooi/items/689801dad2cf2e0a37b4)
ç¬¬3éƒ¨: [è‡ªä½œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’Mintã«å¯¾å¿œã™ã‚‹](https://qiita.com/uhooi/items/fab2fa2f3dc540ad2315)
ç¬¬4éƒ¨: è‡ªä½œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’Homebrewã«è¿½åŠ ã™ã‚‹ï¼ˆæœªæŠ•ç¨¿ï¼‰
ç¬¬5éƒ¨: è‡ªä½œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’CocoaPodsã«è¿½åŠ ã™ã‚‹ï¼ˆæœªæŠ•ç¨¿ï¼‰

## ã¯ã˜ã‚ã«

Swiftè£½ã®CLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹å®Ÿç¸¾ã‚’è§£é™¤ã—ãŸã‹ã£ãŸã®ã§ã€ã‹ã‚“ãŸã‚“ãªCLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

## ã€ŒSwift Packagesã€ã¨ã¯ï¼Ÿ

[ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#swift-packagesã¨ã¯) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

## ç’°å¢ƒ

- OSï¼š macOS Big Sur 11.6
- Xcodeï¼š12.5.1 (12E507)
- Swiftï¼š5.4.2
- swift-toolsï¼š5.4

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½œæˆæ–¹æ³•

ä¾‹ã¨ã—ã¦ã€Œswift-output-uhooiã€ã¨ã„ã†ãƒªãƒã‚¸ãƒˆãƒªã«ã€ŒOutputUhooiã€ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚

### GitHubã«ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹

è©³ç´°ã¯ [ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#githubã«ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

```shell-session
$ git clone https://github.com/uhooi/swift-output-uhooi.git
$ cd swift-output-uhooi
$ git switch -c feature/create_package
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åŸºç›¤ã‚’ç”Ÿæˆã™ã‚‹

è©³ç´°ã¯ [ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åŸºç›¤ã‚’ç”Ÿæˆã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

```shell-session
$ swift package init --name OutputUhooi --type executable
Creating executable package: OutputUhooi
Creating Package.swift
Creating Sources/
Creating Sources/OutputUhooi/main.swift
Creating Tests/
Creating Tests/OutputUhooiTests/
Creating Tests/OutputUhooiTests/OutputUhooiTests.swift
```

### .gitignoreã‚’ä½œæˆã™ã‚‹

[ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#gitignoreã‚’ä½œæˆã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

### CIã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆä»»æ„ï¼‰

ã§ãã‚‹é™ã‚Šå®Ÿè£…å‰ã«CIã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚
GitHub Actionsã‚’ä½¿ãˆã°ä¸€ç¬ã§æ§‹ç¯‰ã§ãã¾ã™ã€‚

```yaml:main.yml
name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  run:
    runs-on: macos-11
    strategy:
      matrix:
        xcode: ["12.5.1", "13.0"]
        subcommand: ["Build", "Test"]
    steps:
    - uses: actions/checkout@v2
    - name: ${{ matrix.subcommand }}
      run: |
        xcodebuild -version
        swift --version
        swift package --version
        subcommand=`echo ${{ matrix.subcommand }} | tr '[:upper:]' '[:lower:]'`
        swift $subcommand -v
      env:
        DEVELOPER_DIR: /Applications/Xcode_${{ matrix.xcode }}.app
```

ã“ã‚Œã§ `main` ãƒ–ãƒ©ãƒ³ãƒã¸PRã‚’å‡ºã™ã¨ãã¨ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨ãï¼ˆPRã®ãƒãƒ¼ã‚¸ã‚’å«ã‚€ï¼‰ã«ã€è‡ªå‹•ã§ãƒ“ãƒ«ãƒ‰ã¨ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

### CDã‚’æ§‹ç¯‰ã™ã‚‹ï¼ˆä»»æ„ï¼‰

GitHub Actionsã‚’ä½¿ã„ã€ãƒªãƒªãƒ¼ã‚¹æ™‚ã«è‡ªå‹•ã§ã‚½ãƒ¼ã‚¹ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€ãƒã‚¤ãƒŠãƒªã‚’ãƒªãƒªãƒ¼ã‚¹ã®ã‚¢ã‚»ãƒƒãƒˆã«è¿½åŠ ã™ã‚‹CDã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

```yaml:release.yml
name: Release

on:
  release:
    types: [published]

env:
  DEVELOPER_DIR: /Applications/Xcode_12.5.1.app

jobs:
  build-release:
    runs-on: macos-11
    steps:
    - uses: actions/checkout@v2
    - name: Build for release
      run: swift build -c release
    - name: Archive the binary
      run: zip -j uhooi.zip .build/release/uhooi
    - name: Upload the binary
      uses: actions/upload-artifact@v2
      with:
        name: uhooi
        path: uhooi.zip
        retention-days: 14

  deploy-binary:
    needs: build-release
    runs-on: macos-11
    steps:
    - uses: actions/download-artifact@v2
      with:
        name: uhooi
    - name: Deploy the binary
      uses: softprops/action-gh-release@v1
      with:
        files: uhooi.zip
```

`uhooi` ã®éƒ¨åˆ†ã¯è‡ªåˆ†ã®ãƒã‚¤ãƒŠãƒªåã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

ã“ã‚Œã§GitHubã‹ã‚‰ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãŸã³ã«è‡ªå‹•ã§ãƒã‚¤ãƒŠãƒªãŒã‚¢ã‚»ãƒƒãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã®ä¾‹ã ã¨ `uhooi.zip` ãŒãƒã‚¤ãƒŠãƒªã‚’åœ§ç¸®ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚
2ã¤ã® `Source code` ã¯ãƒªãƒªãƒ¼ã‚¹æ™‚ã«è‡ªå‹•ã§è¿½åŠ ã•ã‚Œã‚‹ã®ã§ã€æ‰‹å‹•ã‚„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
![ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2021-10-05 19.09.55.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/138245/428aabd9-a493-c9f4-c89c-d63c89b5ab94.png)

### CLIãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè£…ã™ã‚‹

è©³ç´°ãªå®Ÿè£…æ–¹æ³•ã¯åˆ¥è¨˜äº‹ã§ç´¹ä»‹ã™ã‚‹äºˆå®šãªã®ã§ã€æœ¬è¨˜äº‹ã§ã¯çœç•¥ã—ã¾ã™ã€‚
åŸºæœ¬çš„ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆã¯ [ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å®Ÿè£…ã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

### å¯¾å¿œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ˜è¨˜ã™ã‚‹ï¼ˆä»»æ„ï¼‰

è©³ç´°ã¯ [ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#å¯¾å¿œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ˜è¨˜ã™ã‚‹ä»»æ„) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

CLIãƒ„ãƒ¼ãƒ«ãªã®ã§macOSã®ã¿è¨˜è¿°ã™ã‚Œã°OKã§ã™ã€‚

```swift:Package.swift
// ...
let package = Package(
    // ...
    platforms: [
        .macOS(.v10_10),
    ],
    // ...
)
```

### READMEã‚’ç·¨é›†ã™ã‚‹ï¼ˆä»»æ„ï¼‰

æœ€å¾Œã«READMEã‚’ç·¨é›†ã—ã¾ã™ã€‚
æœ€ä½é™ã€ŒCLIãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã€ã¨ã€ŒCLIãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹ã€ãŒã‚ã‚‹ã¨è¦ªåˆ‡ã§ã™ã€‚

è©³ç´°ã¯ [ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#readmeã‚’ç·¨é›†ã™ã‚‹ä»»æ„) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

### å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹

[ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

### ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹

[ã“ã¡ã‚‰](https://qiita.com/uhooi/items/2f36b85f5f41cbd35189#ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹) ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ã„æ–¹

è‡ªä½œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

### ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹

ä»Šå›ã¯æœ€ã‚‚ã‚ã‹ã‚Šã‚„ã™ã„ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ãƒã‚¤ãƒŠãƒªã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

å®Ÿå‹™ã§ã¯ [Mint](https://github.com/yonaskolb/Mint) ã‚„SwiftPMãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã®ãŒæœ›ã¾ã—ã„ã§ã™ã€‚

```shell-session
$ git clone https://github.com/uhooi/swift-output-uhooi.git
$ cd swift-output-uhooi
$ swift build -c release
```

`-c release` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã«ãªã‚Šã¾ã™ã€‚

### ãƒã‚¤ãƒŠãƒªã‚’å®Ÿè¡Œã™ã‚‹

ç”Ÿæˆã—ãŸãƒã‚¤ãƒŠãƒªã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã—ãŸã‚‰ `.build/release` ãƒ•ã‚©ãƒ«ãƒ€ã«ãƒã‚¤ãƒŠãƒªãŒç”Ÿæˆã•ã‚Œã‚‹ã®ã§ã€ `.build/release/{ãƒã‚¤ãƒŠãƒªå}` ã§å®Ÿè¡Œã§ãã¾ã™ã€‚

```shell-session
$ .build/release/uhooi "I'm uhooi."
â”Œ|â–¼â–¼|â”˜<I'm uhooi.
```

è¦‹äº‹ã« `uhooi` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ã‚¦ãƒ›ãƒ¼ã‚¤ã®å–‹ã‚‹AAã‚’å‡ºåŠ›ã§ãã¾ã—ãŸã€‚

### ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹

ã ã„ãŸã„ã®CLIãƒ„ãƒ¼ãƒ«ã«ã¯ãƒ˜ãƒ«ãƒ—ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ `-h` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```shell-session
$ .build/release/uhooi -h
OVERVIEW: Uhooi speak the phrase.

USAGE: uhooi [--include-counter] [--count <count>] <phrase>

ARGUMENTS:
  <phrase>                The phrase to repeat.
            
OPTIONS:
  --include-counter       Include a counter with each repetition.
  -c, --count <count>     The number of times to repeat 'phrase'.
  --version               Show the version.
  -h, --help              Show help information.
```

`uhooi` ã‚³ãƒãƒ³ãƒ‰ã®ãƒ˜ãƒ«ãƒ—ãŒå‡ºåŠ›ã•ã‚Œã¾ã—ãŸã€‚
åˆã‚ã¦ä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹ã¨ä½¿ã„æ–¹ãŒã‚ã‹ã‚‹ã®ã§ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚

## ãŠã‚ã‚Šã«

Swift Packagesã§CLIãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹å®Ÿç¸¾ã‚’è§£é™¤ã§ãã¾ã—ãŸï¼
ã‚¦ãƒ›ãƒ¼ã‚¤ãŒå–‹ã‚‹ã ã‘ã®CLIãƒ„ãƒ¼ãƒ«ã§ã™ãŒã€ã‚ˆã‹ã£ãŸã‚‰ã‚¹ã‚¿ãƒ¼ã‚’ä»˜ã‘ã¦ã€å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ :relaxed:

https://github.com/uhooi/swift-output-uhooi

ã¿ãªã•ã‚“ã®ç´ æ™´ã‚‰ã—ã„è‡ªä½œCLIãƒ„ãƒ¼ãƒ«ã«ã‚‚æœŸå¾…ã—ã¦ã„ã¾ã™ :eyes:

## å‚è€ƒãƒªãƒ³ã‚¯

- [softprops/action-gh-release: ğŸ“¦ GitHub Action for creating GitHub Releases](https://github.com/softprops/action-gh-release)
